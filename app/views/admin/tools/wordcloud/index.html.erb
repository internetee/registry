<% content_for :actions do %>
  <%= link_to t('back'), admin_tools_path, class: 'btn btn-default' %>
<% end %>
<%= render "shared/title", name: t('admin.tools.wordcloud.title') %>

<style>
  .wordcloud-container {
    margin-bottom: 20px;
  }
  .controls-section {
    padding-top: 15px;
    margin-top: 15px;
    border-top: 1px solid #eee;
  }
  .instructions {
    margin-bottom: 15px;
    color: #555;
  }
  .mt-2 {
    margin-top: 10px;
  }
  .wordcloud-container a {
    display: block;
    text-decoration: none;
    padding: 5px;
    border: 1px solid transparent;
    transition: all 0.2s ease;
  }
  .wordcloud-container a:hover {
    border-color: #ddd;
    background-color: #f9f9f9;
    border-radius: 4px;
  }
  .wordcloud-container a small {
    color: #337ab7;
  }
</style>

<div class="row">
  <div class="col-md-12">
    <div class="row">
      <div class="col-md-8">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title"><%= t('admin.tools.wordcloud.title') %></h3>
          </div>
          <div class="panel-body text-center">
            <% if @wordcloud_url %>
              <div class="wordcloud-container">
                <%= link_to @wordcloud_url, target: "_blank", title: t('admin.tools.wordcloud.view_full_size') do %>
                  <%= image_tag @wordcloud_url, class: 'img-responsive', alt: t('admin.tools.wordcloud.title') %>
                  <div class="text-center mt-2">
                    <small><i class="fa fa-search-plus"></i> <%= t('admin.tools.wordcloud.click_to_enlarge') %></small>
                  </div>
                <% end %>
                
                <% if @wordcloud_generated_at %>
                  <div class="text-muted mt-2">
                    <small><i class="fa fa-clock-o"></i> <%= t('admin.tools.wordcloud.generated_at', time: l(@wordcloud_generated_at, format: :long)) %></small>
                  </div>
                <% end %>
              </div>
            <% end %>
            <div class="instructions">
              <p><%= t('admin.tools.wordcloud.instructions') %></p>
            </div>
            <%= render 'admin/tools/wordcloud/form' %>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title"><%= t('admin.tools.wordcloud.top_words') %></h3>
          </div>
          <div class="panel-body">
            <% if @top_words && @top_words.any? %>
              <ol>
                <% @top_words.each do |word, count| %>
                  <li><strong><%= word %></strong>: <%= count %></li>
                <% end %>
              </ol>
            <% else %>
              <p class="text-muted"><%= t('admin.tools.wordcloud.top_words_empty') %></p>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 